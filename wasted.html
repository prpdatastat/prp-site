<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PRP Statistics</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://unpkg.com/sync-fetch"></script>
    <script id='data' src="data.js"></script>
    <script src="schedule.js"></script>
   <script src="nil.js"></script>
   <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <link
    href="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.0.8/r-3.0.2/sl-2.0.3/datatables.min.css"
    rel="stylesheet"
  />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/v/dt/dt-2.0.8/b-3.0.2/b-html5-3.0.2/datatables.min.js"></script>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    
<style>
@keyframes glowPulse {
  0% {
    box-shadow: 0 0 12px rgba(0, 255, 170, 0.2), 0 0 5px rgba(0, 255, 170, 0.1);
  }
  50% {
    box-shadow: 0 0 18px rgba(0, 255, 170, 0.6), 0 0 12px rgba(0, 255, 170, 0.3);
  }
  100% {
    box-shadow: 0 0 12px rgba(0, 255, 170, 0.2), 0 0 5px rgba(0, 255, 170, 0.1);
  }
}

    
    #statTable tbody td:nth-child(1),
#statTable tbody td:nth-child(4),
#statTable tbody td:nth-child(5) {
  color: var(--accent, #5cdb71);
  text-decoration: underline dotted;
  cursor: pointer;
  font-weight: 700;
  transition: color 0.18s, text-decoration 0.18s, text-shadow 0.18s;
}

#statTable tbody tr:hover td:nth-child(1),
#statTable tbody tr:hover td:nth-child(4),
#statTable tbody tr:hover td:nth-child(5),
#statTable tbody td:nth-child(1):hover,
#statTable tbody td:nth-child(4):hover,
#statTable tbody td:nth-child(5):hover {
  color: #fff;
  text-decoration: underline solid;
  text-shadow: 0 2px 12px var(--accent, #5cdb71);
  cursor: pointer;
}
</style>
     <nav class="navbar main-navbar">
      <div class="nav-content">
        <div class="logo-container">
          <img class="logo" onclick="gotoUrl()" src="logo.png" />
        </div>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <!--<li><a href="hospital.html">Hospitals</a></li>-->
          <!--<li><a href="speciality.html">Specialities</a></li>-->
          
          <li><a href="review.html">Training Reviews</a></li>
          <li><a href="cutoff.html">Cutoff Merits</a></li>
          <li><a href="schedule.html">Schedule</a></li>
          <li><a href="/prp-site/2025/index.html">Gazette</a></li>
          <li><a href="prev.html">Previous Merit Lists</a></li>
        </ul>
      </div>
    </nav>

  
<div class="navbar notif" id="notif" style="
  background: #23272a;
  color: #e0e0e0;
  border-left: 5px solid #ff4d4f;
  border-radius: 9px;
  padding: 1em 1.5em;
  margin-bottom: 1.2em;
  font-size: 1.05em;
  box-shadow: 0 2px 12px rgba(255, 77, 79, 0.15);
">

</div>





    <div class="main_container" style="width: 80%">

        <div class="info-section" style="
  background: #1e1e2f;
  color: #eaeaea;
  padding: 1.5em 2em;
  margin: 1.5em auto;
  border-left: 5px solid #5cdb71;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0, 255, 170, 0.1);
  max-width: 900px;
  font-size: 1rem;
  line-height: 1.6;
">
  <h2 style="margin-top: 0; font-size: 1.5em; color: #5cdb71;">üìä PRP Wasted Seats Dashboard</h2>
  <p>
    This dashboard helps you analyze <strong>Postgraduate Residency Program (PRP)</strong> seat allocations across <strong>hospitals, specialities, and quotas</strong> ‚Äî with a unique focus on identifying <span style="color: #ff7373; font-weight: bold;">wasted seats</span>.
  </p>
  <ul style="list-style: none; padding-left: 1em;">
    <li>üßÆ View how many <strong>candidates did not join</strong> each seat</li>
    <li>üè• Analyze <strong>wasted seats by hospital and speciality</strong></li>
    <li>üïµÔ∏è‚Äç‚ôÇÔ∏è Hover on candidate IDs to reveal name and PMDC via tooltip</li>
    <li>üìÑ Export the table as a <strong>PDF</strong> for reporting and reference</li>
    <li>üó®Ô∏è Leave feedback or questions in the <strong>comment section</strong> below</li>
  </ul>
  <p>
    This tool was built to increase transparency, track inefficiencies in the induction process, and support data-driven improvements for future intakes.
  </p>
</div>



      
      <div>
        <!--<button class="schd-button lrgbtn" onmousedown="gotoUrl('schedule.html')"> View PRP Schedule </button>-->
       <!-- <button class="schd-button lrgbtn" onmousedown="gotoUrl('scrutiny.html')"> View 2025 Grievance List </button> -->
        

        <!--<h3 class="simple-text">Unofficial <small class='important'> click on buttons below</small></h3>        
        <br>
        <button class="schd-button lrgbtn" onmousedown="gotoUrl('/prp-site/2025/index.html')">June Unofficial 2025 Gazette </button>
        <button class="schd-button lrgbtn" onmousedown="gotoUrl('/prp-site/scrutiny.html')"> View June Rejected List </button>
        <br>-->
        <!--
        <button class="schd-button lrgbtn unofficial" onmousedown="gotoUrl('/prp-site/2025/merit.html')">Feb 2025 Merit </button>
        <button class="schd-button lrgbtn unofficial" onmousedown="gotoUrl('/prp-site/2025/rejection.html')">Feb 2025 Scrutiny</button>
         -->
      </div>    
      <!--
      <div class="consent-pref-switch">
        <label class="switch">
          <input id="checkbox2025" onchange="changeMeritYear(this)" type="checkbox">
          <span class="slider"></span>
        </label><span class="slidertext"> 2025 Unofficial Merit List</span> 
      </div>  
       -->
      
  <div class="filters">
        <select
          onchange="updateList(event);"
          class="filter-item"
          name="quota"
          id="program"
        >
          <option value="" disabled selected>Program</option>
        </select>
        <select
          onchange="updateList(event);"
          class="filter-item"
          name="speciality"
          id="quota"
        >
          <option value="" selected>Quota</option>
        </select>
        <select
          onchange="updateList(event);"
          class="filter-item"
          name="quota"
          id="speciality"
        >
          <option value="" selected>Speciality</option>
        </select>
        <select
          onchange="updateList(event);"
          class="filter-item"
          name="quota"
          id="hospital"
        >
          <option value="" elected>Hospital</option>
        </select>
      </div>




     
  
      <table class="stat-table" style="width: 100%" id="statTable">
        <thead>
          <tr>            
            <th>Quota</th>
            <th class="linkable">Speciality</th>
            <th class="linkable">Hospital</th>
            <th>Candidates</th>
            <!--<th>Next Candidate in Line</th>--->
          </tr>
        </thead>
        <tbody id="dataRows"></tbody>
      </table>
      
<div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">Comment Box</a> is loading comments...</div>
</div>
      <br>
     
<br>
<script type="text/javascript" id="hcb"> /*<!--*/ if(!window.hcb_user){hcb_user={};} (function(){var s=document.createElement("script"), l=hcb_user.PAGE || (""+window.location).replace(/'/g,"%27"), h="https://www.htmlcommentbox.com";s.setAttribute("type","text/javascript");s.setAttribute("src", h+"/jread?page="+encodeURIComponent(l).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24mzyYuuZBe1GhURDyiqYE4%2F"+"&opts=16798&num=10&ts=1736005452841");if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})(); /*-->*/ </script>
<!-- end www.htmlcommentbox.com -->

      <div class="footer">
        <span>Made with üíì in <strong>HTML</strong>  &  <strong>JS</strong> by <img src="github.png">reko-beep</span>
      </div>
    </div>
  </body>
  

  <script>
    const default_filter = {
      program: "FCPS",
      quota: "",
      speciality: "",
      hospital: "",
    };
   
  



    jQuery(document).ready(function () {
       // Prevent duplicate box rendering
  
  
  $('.slidertext').css({'color': 'white','font-weight': 'light', 'filter': 'drop-shadow(0px 0px 0px #107e47)', 'transition-duration': '1s'})
    
      jQuery("#statTable").DataTable({
        order: [[5, 'desc']],
        paging: true,
        searching: true,
        ordering: true,
        lengthMenu: [10, 25, 50, { label: "All", value: -1 }],
        lengthChange: true,
        drawCallback: function () {
    // Reinitialize Tippy tooltips after table redraw
    tippy('[data-tippy-content]', {
      allowHTML: true,
      placement: 'top',
      theme: 'light-border',
      interactive: false,
      animation: 'scale-subtle',
      delay: [100, 0],
    });
  },
        layout: {
          topStart: {
              buttons: [
                {
                    extend: 'pdfHtml5',
                    text: 'Download PDF',
                    title : 'officialFirstRoundMeritList',
                    filename : function(){
                     default_filter.program + 'officialFirstRoundMeritList'
                    },

                    customize: function (doc) {
                        
                        let table = doc.content[1].table.body;
                        console.log(table)
                        for (i = 1; i < table.length; i++) // skip table header row (i = 0)
                        {
                          let txt = table[i][6].text.replace('Check Joining', '')
                          table[i][6].text = txt; // couldn't be bothered clearing the Age column sample data above :)
                          
                        }
                        console.log(doc['header'])
                        var cols = [];
                        cols[0] = {text: 'List downloaded', alignment: 'left', margin:[20] };
                        cols[1] = {text: 'from PRP statistics', alignment: 'right', margin:[0,0,20] };
                        var objFooter = {};
                        objFooter['columns'] = cols;
                        doc['footer']=objFooter;

                        }
                        }
                        // Data URL generated by http://dataurl.net/#dataurlmaker
                    
                
            ]
          }
    },
    
        columns: [
          { width: "10%" },
          { width: "20%" },
          { width: "10%" },
          { width: "10%" },
         
        ],
      });
      changeWastedList();
    });
    
    async function changeWastedList() {
      let merit = getWastedData(
        wastedData[default_filter.program],
        default_filter.program,
        default_filter.quota,
        default_filter.speciality,
        default_filter.hospital
      );
     
      jQuery("#statTable").DataTable().clear().draw();
      for (cand in merit) {
        let candBlock = '';
        if (merit[cand].candidates.length == 0) {
          candBlock += `<span class='join-item'><b>Everyone joined</b></span>`
        }
        else {            
            for (let c in merit[cand].candidates)
            {
            let pmdc = getPMDCNo(String(merit[cand].candidates[c]));
            if (pmdc) {
                
            let candidate = getCandidatesData(pmdc);

            candBlock += `<span class='nonjoin-item' data-tippy-content='Name: ${candidate.name}<br>PMDC No: ${pmdc}' onmousedown=gotoUrl('https://prpdatastat.github.io/prp-site/candidate.html?pmdcNo=${pmdc})><b>${merit[cand].candidates[c]}</b></span>`
            }
            
            }
        }
        jQuery("#statTable")
          .DataTable()
          .row.add([
  merit[cand].quotaName,
  merit[cand].specialityName,
  merit[cand].hospitalName,
  candBlock,

]);
      }
      jQuery("#statTable").DataTable().draw();
      tippy('[data-tippy-content]', {
    allowHTML: true,
    placement: 'top',
    theme: 'light-border',
    interactive: false,
    animation: 'scale-subtle',
    delay: [100, 0],
  });
    }
    
      






    function animateValue(obj, start, end, duration) {
      let startTimestamp = null;
      const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const progress = Math.min((timestamp - startTimestamp) / duration, 1);
        obj.innerHTML = Math.floor(progress * (end - start) + start);
        if (progress < 1) {
          window.requestAnimationFrame(step);
        }
      };
      window.requestAnimationFrame(step);
    }

    const filters = document.getElementsByTagName("select");
    console.log(filters);
    for (filter in filters) {
      let options = getOptions(String(filters[filter].id).replace('filter-', '') || filters[filter].id);
      for (opt in options) {
        filters[filter].innerHTML +=
          "<option value='" + options[opt] + "'>" + options[opt] + "</option>";
      }
    }
    for (key in default_filter) {
      const ele = document.getElementById(key);
      ele.value = default_filter[key];
    }
    function updateList(e) {
      default_filter[e.target.id] = e.target.value;
      console.log(default_filter);
      changeWastedList();
    }
   

    window.addEventListener('load', function() {
  setTimeout(function() {
    document.getElementById('loading-overlay').style.opacity = 0;
    setTimeout(function() {
      document.getElementById('loading-overlay').style.display = 'none';
    }, 400);
  }, 300); // Optional: keep spinner for at least 300ms for smoothness
});
    /*
    function changeMeritYear(e) {
      
  if (e.checked) {
    localStorage.setItem('viewUnofficial', 'true');
    meritData.FCPS = fcpsMeritUnOfficial;
    meritData.MS = msMeritUnOfficial;
    meritData.MD = mdMeritUnOfficial;
    candData = candDataUnOfficial;
    changeMeritList()
    $('.slidertext').css({'color': 'white', 'font-weight': 'bold', 'filter': 'drop-shadow(0px 0px 7px #107e47)', 'transition-duration': '1s'})
    changeNotification("This is a unofficial Merit list based on unofficial<span class='important'> 2025 Jan</span> Gazette<br>To compare ur merit, see unofficial gazette and click on applicant ID <br><span class='important'>Click on speciality or hospital to see individual merits</span><br>Merit list is updated according to current policy, without program marks.<br><span class='important'>Now you can see how many seats are occupied for  specific speciality and hospital</span>")
    
  }else {
    localStorage.setItem('viewUnofficial', 'false');
    meritData.FCPS = prevfcpsMeritList;
    meritData.MS = prevMsMeritList;
    meritData.MD = prevMdMeritList;
    candData = prevcandList;
    changeMeritList()
    changeNotification(" This is the Estimated Merit List of <span class='important'>2025 Jan</span> Induction<br>Accuracy of unofficial merit list has been displayed below<span class='important'>  </div>")
    $('.slidertext').css({'color': 'white','font-weight': 'light', 'filter': 'drop-shadow(0px 0px 0px #107e47)', 'transition-duration': '1s'})
    

  }
}*/
function gotoComment(){
  const ele = document.getElementById('HCB_comment_box');
  ele.scrollIntoView();
}
  </script>
 
  </style>
</html>
